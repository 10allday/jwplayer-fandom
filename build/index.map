{"version":3,"sources":["idle-screen.js","index.js"],"names":["wikiaJWPlayerIdleScreen","playerInstance","i18n","on","showDuration","id","playerElement","document","getElementById","title","querySelector","titlePrimary","durationElement","createElement","durationWatchElement","durationTimeElement","className","innerText","watch","duration","getDuration","minutes","Math","floor","seconds","appendChild","insertBefore","getUserFriendlyDuration","loadCallbacks","window","wikiaJWPlayer","elementId","options","callback","loadJWPlayerScript","playerURL","jwplayer","push","length","createScriptTag","script","onload","wikiaJWPlayerSettingsPlugin","register","sharing","wikiaJWPlayerSharingPlugin","showSmallPlayerControls","wikiaJWPlayerSmallPlayerControls","forEach","async","src","parentNode","nextSibling","logger","wikiaJWPlayerLogger","lang","wikiaJWPlayeri18n","setupPlayer","videoId","videoDetails","playlist","mediaid","willAutoplay","autoplay","langForAds","substr","playerSetup","advertising","autoplayadsmuted","client","vpaidcontrols","admessage","cuetext","skipmessage","skiptext","setLocale","autostart","hidden","description","image","mute","localization","repeat","settings","plugins","showAutoplayToggle","showQuality","showCaptions","selectedCaptionsLanguage","related","autoplaytimer","time","file","playlistId","oncomplete","autoplaymessage","nextUpInSeconds","watermark","info","setup","subscribeToPlayerErrors","wikiaJWPlayerReplaceIcons","wikiaJWPlayerEvents","wikiaJWPlayerRelatedVideoSound","tracking","pixel","wikiaJWPlayerTracking","wikiaJWPlayerHandleTabNotActive","wikiaJWPlayerAllowControllOnTouchDevices","WikiaJWPlayerWatermarkPlugin"],"mappings":"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","file":"index.map","sourceRoot":"../src","sourcesContent":["export default function wikiaJWPlayerIdleScreen(playerInstance, i18n) {\n\tfunction showDuration() {\n\t\tvar id = playerInstance.id,\n\t\t\tplayerElement = document.getElementById(id),\n\t\t\ttitle = playerElement.querySelector('.jw-title'),\n\t\t\ttitlePrimary = playerElement.querySelector('.jw-title-primary'),\n\t\t\tdurationElement = document.createElement('div'),\n\t\t\tdurationWatchElement = document.createElement('span'),\n\t\t\tdurationTimeElement = document.createElement('span');\n\n\t\tdurationElement.className = 'wikia-jw-title-duration';\n\t\tdurationWatchElement.className = 'wikia-jw-title-duration-watch';\n\t\tdurationTimeElement.className = 'wikia-jw-title-duration-time';\n\t\tdurationWatchElement.innerText = i18n.watch;\n\t\tdurationTimeElement.innerText = getUserFriendlyDuration(playerInstance.getDuration());\n\n\t\tdurationElement.appendChild(durationWatchElement);\n\t\tdurationElement.appendChild(durationTimeElement);\n\n\t\ttitle.insertBefore(durationElement, titlePrimary);\n\t}\n\n\tfunction getUserFriendlyDuration(duration) {\n\t\tvar minutes = Math.floor(duration / 60),\n\t\t\tseconds = duration % 60;\n\n\t\tif (seconds < 10) {\n\t\t\tseconds  = '0' + seconds;\n\t\t}\n\n\t\tif (minutes < 10) {\n\t\t\tminutes  = '0' + minutes;\n\t\t}\n\n\t\treturn minutes + ':' + seconds;\n\t}\n\n\tplayerInstance.on('ready', showDuration);\n}\n\n// window.wikiaJWPlayerIdleScreen = wikiaJWPlayerIdleScreen;\n","import wikiaJWPlayerIdleScreen from './idle-screen'\n\nvar loadCallbacks = [];\n\nwindow.wikiaJWPlayer = function (elementId, options, callback) {\n\n\t/**\n\t * adds script tag\n\t * @param elementId\n\t * @param playerURL\n\t */\n\tfunction createScriptTag(elementId, playerURL) {\n\t\tvar script = document.createElement('script'),\n\t\t\tplayerElement = document.getElementById(elementId);\n\n\t\tscript.onload = function () {\n\t\t\twikiaJWPlayerSettingsPlugin.register();\n\n\t\t\tif (options.sharing) {\n\t\t\t\twikiaJWPlayerSharingPlugin.register();\n\t\t\t}\n\n\t\t\tif (options.showSmallPlayerControls) {\n\t\t\t\twikiaJWPlayerSmallPlayerControls.register();\n\t\t\t}\n\n\t\t\tloadCallbacks.forEach(function (callback) {\n\t\t\t\tcallback();\n\t\t\t});\n\t\t};\n\t\tscript.async = true;\n\t\tscript.src = playerURL || 'https://content.jwplatform.com/libraries/VXc5h4Tf.js';\n\t\t// insert script node just after player element\n\t\tplayerElement.parentNode.insertBefore(script, playerElement.nextSibling);\n\t}\n\n\t/**\n\t * loads jwplayer library\n\t * @param elementId\n\t * @param playerURL\n\t * @param callback\n\t */\n\tfunction loadJWPlayerScript(elementId, playerURL, callback) {\n\t\tif (typeof jwplayer !== 'undefined') {\n\t\t\tcallback();\n\t\t} else {\n\t\t\tloadCallbacks.push(callback);\n\n\t\t\t// we don't want to load multiple jwplayer libraries\n\t\t\tif (loadCallbacks.length === 1) {\n\t\t\t\tcreateScriptTag(elementId, playerURL);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * setups player\n\t * @param elementId\n\t * @param options\n\t * @param logger\n\t * @param lang\n\t * @param i18n\n\t * @return {*}\n\t */\n\tfunction setupPlayer(elementId, options, logger, lang, i18n) {\n\t\tvar playerInstance = jwplayer(elementId),\n\t\t\tvideoId = options.videoDetails.playlist[0].mediaid,\n\t\t\twillAutoplay = options.autoplay,\n\t\t\t// IMA supports two-letter ISO 639-1 code\n\t\t\tlangForAds = lang.substr(0, 2),\n\t\t\tplayerSetup = {\n\t\t\t\tadvertising: {\n\t\t\t\t\tautoplayadsmuted: willAutoplay,\n\t\t\t\t\tclient: 'googima',\n\t\t\t\t\tvpaidcontrols: true,\n\t\t\t\t\tadmessage: i18n.admessage,\n\t\t\t\t\tcuetext: i18n.cuetext,\n\t\t\t\t\tskipmessage: i18n.skipmessage,\n\t\t\t\t\tskiptext: i18n.skiptext,\n\t\t\t\t\tsetLocale: langForAds\n\t\t\t\t},\n\t\t\t\tautostart: willAutoplay && !document.hidden,\n\t\t\t\tdescription: options.videoDetails.description,\n\t\t\t\timage: '//content.jwplatform.com/thumbs/' + videoId + '-640.jpg',\n\t\t\t\tmute: options.mute,\n\t\t\t\tplaylist: options.videoDetails.playlist,\n\t\t\t\ttitle: options.videoDetails.title,\n\t\t\t\tlocalization: i18n,\n\t\t\t\trepeat: options.repeat\n\t\t\t};\n\n\t\tplayerSetup.plugins = {};\n\n\t\tif (options.settings) {\n\t\t\tplayerSetup.plugins['wikiaSettings'] = {\n\t\t\t\tshowAutoplayToggle: options.settings.showAutoplayToggle,\n\t\t\t\tshowQuality: options.settings.showQuality,\n\t\t\t\tshowCaptions: options.settings.showCaptions,\n\t\t\t\tautoplay: options.autoplay,\n\t\t\t\tselectedCaptionsLanguage: options.selectedCaptionsLanguage,\n\t\t\t\ti18n: i18n\n\t\t\t};\n\t\t}\n\n\t\tif (options.sharing) {\n\t\t\tplayerSetup.plugins['wikiaSharing'] = {\n\t\t\t\ti18n: i18n\n\t\t\t};\n\t\t}\n\n\t\tif (options.related) {\n\t\t\tplayerSetup.related = {\n\t\t\t\tautoplaytimer: options.related.time || 3,\n\t\t\t\tfile: '//cdn.jwplayer.com/v2/playlists/' + options.related.playlistId + '?related_media_id=' + videoId,\n\t\t\t\toncomplete: options.related.autoplay ? 'autoplay' : 'show',\n\t\t\t\tautoplaymessage: i18n.nextUpInSeconds\n\t\t\t};\n\t\t}\n\n\t\tif (options.watermark !== false) {\n\t\t\tplayerSetup.plugins['wikiaWatermark'] = {};\n\t\t}\n\n\t\tif (options.showSmallPlayerControls) {\n\t\t\tplayerSetup.plugins['smallPlayerControls'] = {};\n\t\t}\n\n\t\tlogger.info('setupPlayer');\n\t\tplayerInstance.setup(playerSetup);\n\t\tlogger.info('after setup');\n\t\tlogger.subscribeToPlayerErrors(playerInstance);\n\n\t\treturn playerInstance;\n\t}\n\n\tloadJWPlayerScript(elementId, options.playerURL, function () {\n\t\tvar logger = wikiaJWPlayerLogger(options),\n\t\t\tlang = options.lang || 'en',\n\t\t\ti18n = wikiaJWPlayeri18n[lang] || wikiaJWPlayeri18n['en'],\n\t\t\tplayerInstance = setupPlayer(elementId, options, logger, lang, i18n);\n\n\t\twikiaJWPlayerIdleScreen(playerInstance, i18n);\n\t\twikiaJWPlayerReplaceIcons(playerInstance);\n\t\twikiaJWPlayerEvents(playerInstance, options.autoplay, logger);\n\n\t\tif (options.related) {\n\t\t\twikiaJWPlayerRelatedVideoSound(playerInstance);\n\t\t}\n\n\t\tif (options.tracking) {\n\t\t\toptions.tracking.pixel = options.videoDetails.playlist[0].pixel;\n\t\t\twikiaJWPlayerTracking(playerInstance, options.autoplay, options.tracking);\n\t\t}\n\n\t\twikiaJWPlayerHandleTabNotActive(playerInstance, options.autoplay);\n\n\t\twikiaJWPlayerAllowControllOnTouchDevices(playerInstance);\n\n\t\tif(options.watermark !== false) {\n\t\t\tWikiaJWPlayerWatermarkPlugin.register();\n\t\t}\n\n\t\tif (callback) {\n\t\t\tcallback(playerInstance);\n\t\t}\n\t});\n};\n"]}